<!DOCTYPE html>

<!-- Written with love by Dante James Falzone
     https://github.com/DanteFalzone0 -->

<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>ECS API Docs</title>
    <style>

        body {
            font-family: Sans-serif;
            line-height: 1.2em;
            background-color: #EEEEEE;
        }

        code {
            /* TODO: make it so that code elements
               don't go offscreen on tiny monitors */
            font-family: Consolas, monospace;
        }

        .indent {
            position: relative;
            left: 50px;
        }

        .inline-code-0 {
            white-space: pre-wrap;
            font-family: Consolas, monospace;
        }

    </style>
</head>

<!-- TODO make this autogenerated so we don't need to write HTML by hand -->

<body>
    <div style="font-size:200%">
        Documentation for the Elkhorn Computer Service REST API
    </div>
    <br>
    <strong>This document describes the usage of all the publicly visible API functions maintained
    by ECS for public and internal use. Undocumented functions may not work consistently or
    indefinitely and are only maintained for internal use. No part of this document should be
    interpreted to suggest or imply any kind of warranty or guarantee of service.</strong>
    <hr>
    <div>
        <h2><a href="https://api.ecs.rocks/v0/util/parsePhoneNumber">parsePhoneNumber</a></h2>
        <h3>Endpoint URL</h3>
        <div class="indent">
            <code>
                https://api.ecs.rocks/v0/util/parsePhoneNumber
            </code>
        </div>
        <h3>Description</h3>
        <div class="indent">
            Extracts phone numbers enclosed in square brackets from text.
        </div>
        <h3>Accepts</h3>
        <div class="indent">
            <code>event-subject</code> : (string) an arbitrary string describing the event that triggered the API<br>
            <code>event-body</code> : (string) text containing phone numbers enclosed in square brackets<br>
        </div>
        <h3>Returns</h3>
        <div class="indent">
            <h4>On success</h4>
            <div class="indent">
                <code>status</code> : (number) 200<br>
                <code>phone-number-list</code> : (boolean) true<br>
                <code>event-subject</code> : (string) whatever was sent as `event-subject` in the request<br>
                <code>phone-numbers</code> : (array of string) an array containing the phone numbers parsed from the request data<br>
            </div>
            <h4>On failure</h4>
            <div class="indent">
                <code>status</code> : (number) 400<br>
                <code>message</code> : (string) an error message explaining what's wrong<br>
            </div>
        </div>
        <h3>cURL Example</h3>
        <div class="indent">
            <h4>Request</h4>
            <!-- It's broken up in the HTML source code, but it has to be on one line if you actually
                 type it into a shell prompt. Obviously. -->
            <code>$ curl -X POST --data '{"event-subject": "Example event", "event-body":
            "Our API is very liberal about phone numbers; observe: [402-000-0000] [(400) 111-1111] [1234567]"}'
            https://api.ecs.rocks/v0/util/parsePhoneNumber</code><br><br>
            <h4>Response</h4>
            <div class="inline-code-0">{
    "status": 200,
    "phone-number-list": true,
    "event-subject": "Example event",
    "phone-numbers": [
        "+14020000000",
        "+14001111111",
        "+14021234567"
    ]
}</div>
        </div>
    </div>

    <hr>
    <div>
        <h2><a href="https://api.ecs.rocks/v0/sms/sendReminderSMS">sendReminderSMS</a></h2>
        <h3>Endpoint URL</h3>
        <div class="indent">
            <code>
                https://api.ecs.rocks/v0/sms/sendReminderSMS
            </code>
        </div>
        <h3>Description</h3>
        <div class="indent">
            Sends text messages, either to a single recipient or to multiple recipients. A request
            to text a single recipient is differently formed than a request to text multiple
            recipients; see the sections below for details.
        </div>
        <h3>Accepts</h3>
        <div class="indent">
            <h4>Single recipient</h4>
            <div class="indent">
                <code>auth-api-key</code> : (string) an authentication key consisting of "elkhorn_" followed by a string
                                            of alphanumeric characters<br>
                <code>event-text</code> : (string) the message to send via SMS<br>
                <code>destination-number</code> : (string) the phone number to which the message is sent
                                                  (must follow the form "+1XXXXXXXXXX")<br>
            </div>
            <h4>Multiple recipients</h4>
            <div class="indent">
                <code>auth-api-key</code> : (string) an authentication key consisting of "elkhorn_" followed by a string
                                            of alphanumeric characters<br>
                <code>phone-number-list</code> : (boolean) must be `true` for the API to know we're sending to multiple recipients<br>
                <code>event-subject</code> : (string) the message to send via SMS<br>
                <code>phone-numbers</code> : (array of string) the recipient phone numbers (must follow the form
                                             "+1XXXXXXXXXX")<br>

            </div>
        </div>
        <h3>Returns</h3>
        <div class="indent">
            <h4>On success</h4>
            <div class="indent">
                <code>status</code> : (number) 200<br>
                <code>text</code> : (string) "Message sent!"<br>
                <code>message</code> : (string) the recipient(s) receive this followed by "\r\n\r\nReply STOP to unsubscribe."<br>
                <code>data</code> : (object) exact copy of the request data<br>
            </div>
            <h4>On failure</h4>
            <div class="indent">
                <code>status</code> : (number) 400<br>
                <code>text</code> : (string) "Message ***NOT*** sent!"<br>
                <code>message</code> : (string) error message describing what's wrong<br>
                <code>data</code> : (object) exact copy of the request data<br>
            </div>
        </div>
        <h3>cURL Examples</h3>
        <div class="indent">
            <h4>Single recipient</h4>
            <div class="indent">
                <h4>Request</h4>
                <code>$ curl -X POST --data '{"auth-api-key": "elkhorn_XXXXXXXXXXXXXXXXXXXX",
                "event-text": "This is the message that gets sent!", "destination-number":
                "+14020000000"}' https://api.ecs.rocks/v0/sms/sendReminderSMS
                </code><br>
                <h4>Response</h4>
                <div class="inline-code-0">{
    "status": 200,
    "text": "Message sent!",
    "message": "This is the message that gets sent!",
    "data": {
        "event-text": "This is the message that gets sent!",
        "destination-number": "+14020000000",
        "auth-api-key": "elkhorn_XXXXXXXXXXXXXXXXXXXX"
    }
}</div>
            </div>
            <h4>Multiple recipients</h4>
            <div class="indent">
                <h4>Request</h4>
                <code>$ curl -X POST --data '{"auth-api-key": "elkhorn_XXXXXXXXXXXXXXXXXXXX",
                "phone-number-list": true, "event-subject": "This message gets sent to multiple numbers!",
                "phone-numbers": ["+14021111111", "+18006666666", "+12345678900"]}'
                https://api.ecs.rocks/v0/sms/sendReminderSMS
                </code><br>
                <h4>Response</h4>
                <div class="inline-code-0">{
    "status": 200,
    "text": "Message sent!",
    "message": "This message gets sent to multiple numbers!",
    "data": {
        "auth-api-key": "elkhorn_XXXXXXXXXXXXXXXXXXXX",
        "phone-number-list": true,
        "event-subject": "This message gets sent to multiple numbers!",
        "phone-numbers": [
            "+14021111111",
            "+18006666666",
            "+12345678900"
        ]
    }
}</div>
            </div>
        </div>
    </div>

    <hr>
    <div>
        <h2><a href="https://api.ecs.rocks/v0/util/removeMessageHeader">removeMessageHeader</a></h2>
        <h3>Endpoint URL</h3>
        <div class="indent">
            <code>
                https://api.ecs.rocks/v0/util/removeMessageHeader
            </code>
        </div>
        <h3>Description</h3>
        <div class="indent">
            Removes all characters up to and including the last instance of <code>']'</code> in a string.
        </div>
        <h3>Accepts</h3>
        <div class="indent">
            <code>message</code> : (string) the string to trim characters from<br>
        </div>
        <h3>Returns</h3>
        <div class="indent">
            <h4>On success</h4>
            <div class="indent">
                <code>status</code> : (number) 200<br>
                <code>message</code> : (string) <code>message</code> with all characters up to and including <code>']'</code> removed<br>
            </div>
            <h4>On failure</h4>
            <div class="indent">
                <code>status</code> : (number) 400<br>
                <code>message</code> : (string) error message describing what went wrong<br>
            </div>
        </div>
        <h3>cURL Example</h3>
        <div class="indent">
            <h4>Request</h4>
            <code>$ curl -X POST --data '{"message": "[This text will be removed] This text will remain"}'
            https://api.ecs.rocks/v0/util/removeMessageHeader</code><br>
            <h4>Response</h4>
            <div class="inline-code-0">{
    "status": 200,
    "message": " This text will remain"
}</div>
        </div>
    </div>

    <hr>
    <div>
        <!-- TODO document more functions -->
    </div>

</body>
</html>
